---
layout: post
title: IL2CPP Compile Option
description: "IL2CPP Compile Option"
tags: [IL2CPP Unity Compile]
---

----------------------
# Compiler options IL2CPP编译时选项

When using the [IL2CPP](https://docs.unity3d.com/Manual/IL2CPP.html) scripting backend, it is possible to control how **il2cpp.exe** generates C++ code. Specifically, C# attributes can be used to enable or disable the following runtime checks listed below.

当使用IL2CPP脚本后端的时候，我们是能够控制il2cpp.exe如何生成C++代码。特别的，C#属性能控制开启或关闭下面的运行时检查。下面这些检查都可以不开启，不过还需要自己项目的情况来决定。

| **Option**                | **Description**                          | **Default** |
| ------------------------- | ---------------------------------------- | ----------- |
| **Null checks**           | If this option is enabled, C++ code generated by IL2CPP will contain null checks and throw managed NullReferenceException exceptions as necessary. If this option is disabled, the null checks are not be emitted into the generated C++ code. For some projects, disabling this option may improve runtime performance. However, any access to null values in the generated code will not be protected, and may lead to incorrect behavior. *Usually* the game will crash soon after the null value is dereferenced, but we cannot guarantee this. Disable this option with caution. | Enabled     |
| **Array bounds checks**   | If this option is enabled, C++ code generated by IL2CPP will contain array bounds checks and throw managed IndexOutOfRangeException exceptions as necessary. If this option is disabled, the array bounds checks will not be emitted into the generated C++ code. For some projects, disabling this option may improve runtime performance. However, any access to an array with invalid indices in the generated code will not be protected, and may lead to incorrect behavior, including reading from or writing to arbitrary memory locations. In most cases, these memory accesses will occur without any immediate side effects, and may silently corrupt the state of the game. Disable this option with extreme caution. | Enabled     |
| **Divide by zero checks** | If this option is enabled, C++ code generated by IL2CPP will contain divide by zero checks for integer division and throw managed DivideByZeroException exceptions as necessary. If this option is disabled, the divide by zero checks on integer division will not be emitted into the generated C++ code. For most projects this option should be disabled. Enable it only if divide by zero checks are required, as these checks have a runtime cost. | Disable     |

The runtime checks can be enabled or disabled in C# code using the `Il2CppSetOptions` attribute. To use this attribute, find the *Il2CppSetOptionsAttribute.cs* source file in the *IL2CPP* directory in the Unity Editor installation on your computer. (*Data\il2cpp* on Windows, *Contents/Frameworks/il2cpp* on OS X). Copy this source file into the *Assets* folder in your project. 

运行时检查可以通过C#的*Il2CppSetOptions*属性来开启或关闭。为了使用这个属性，可在 *Data\il2cpp* on Windows, *Contents/Frameworks/il2cpp* on OS X的路径上找到Il2CppSetOptionsAttribute.cs文件。把此文件拷贝到你的工程的Assets目录下。

Now use the attribute as in hte example below.

```
[Il2CppSetOption(Option.NullChecks, false)]
public static string MethodWithNullChecksDisabled()
{
    var tmp = new object();
    return tmp.ToString();
}
```

You can apply *Il2CppSetOptions*attribute to types, methods, and properties. Unity uses the attribute from the most local scope.

你可以把 *Il2CppSetOptions*属性放到类型，方法和属性（properties）上。Unity使用本地最近的attribute属性。

```
[Il2CppSetOption(Option.NullChecks, false)]
public class TypeWithNullChecksDisabled
{
    public static string AnyMethod()
    {
        // Null checks will be disabled in this method.
        var tmp = new object();
        return tmp.ToString();
    }

    [Il2CppSetOption(Option.NullChecks, true)]
    public static string MethodWithNullChecksEnabled()
    {
        // Null checks will be enabled in this method.
        var tmp = new object();
        return tmp.ToString();
    }
}

public class SomeType
{
    [Il2CppSetOption(Option.NullChecks, false)]
    public string PropertyWithNullChecksDisabled
    {
        get
        {
            // Null checks will be disabled here.
            var tmp = new object();
            return tmp.ToString();
        }
        set
        {
            // Null checks will be disabled here.
            value.ToString();
        }
    }

    public string PropertyWithNullChecksDisabledOnGetterOnly
    {
        [Il2CppSetOption(Option.NullChecks, false)]
        get
        {
            // Null checks will be disabled here.
            var tmp = new object();
            return tmp.ToString();
        }
        set
        {
            // Null checks will be enabled here.
            value.ToString();
        }
    }
}
```